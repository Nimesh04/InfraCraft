<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!-- <meta http-equiv="refresh" content="5">  -->
        <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
        <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.png') }}">
        <link href="https://fonts.googleapis.com/css2?family=Fira+Code&family=JetBrains+Mono&display=swap" rel="stylesheet">
        <title>InfraCraft</title>
    </head>

    <body> 
        <div class="sidebar_brand">
            <span class="brand_name">InfraCraft</span>
        </div>
        <div class="main">
            <div class="left_container">
                <div class="left_container_box"> 
                    <a href="/" class="nav_button">
                        <img src="{{ url_for('static', filename='icons/add.png') }}" alt="Submit Icon" class="nav_icon">Submit Job</a>
                    <a href="/live_job" class="nav_button">
                        <img src="{{ url_for('static', filename='icons/pulse.png') }}" alt="Live Jobs Icon" class="nav_icon">Live Jobs</a>
                    <a href="/status" class="nav_button">
                        <img src="{{ url_for('static', filename='icons/checked.png') }}" alt="Status Icon" class="nav_icon">Status</a>
                </div>                
            </div>
            <div class="main_middle_body">
                <h2 class="submit_job_hdn"> Submit Job</h2>
                <p class="submit_job_p"> Submit a new shell command to run as a background job</p>
    
                <div class="enter_command_container">
                    <form action="/submit" method="POST">
                        <h2 class="enter_hdn"> New Command </h2>
                        <p class="enter_p">Choose a Command</p>
                        <select  class="command_input_section" name="command" requied>
                            <option value="" disabled selected>Select a job to run</option>
                            {% for script in script_options %}
                                <option value="{{ script }}">{{ script }}</option>
                            {% endfor %}
                        </select>

                        <button class="submit_job_btn" type="submit">Submit Job</button>
                    </form>
                </div>
    
                <div class="recent_job_container">
                    <h2 class="recent_p">Recent jobs</h2>

                    {% if recent_jobs %}
                            {% for job in recent_jobs %}
                            <div class="all_jobs submit_job">
                                <div>
                                    <span>{{ job.command if job.command else job['command']}}</span>
                                    <p class="submit_time"> {{ job.submitted_at if job.submitted_at else job['submitted_at']}} â€¢ <span> Job ID:{{job.jobID if job.jobID else job["jobID"]}}</span></p>
                                </div>
                                    <span class="submit_span {{ 'status_completed' if job['status'] == 'Completed' else 'status_failed'}}"> {{ job.status if job.status else job['status']}}</span>
                            </div>    
                            {% endfor %}
                    {% else %}
                        <p class="no_job"> No recent jobs yet.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </body>

    <footer>
        <p>ðŸš€ Powered by InfraCraft Systems. Built for Builders.</p>
    </footer>
</html>